<h1><%= @user.name %>さんのページ</h1>

<%= render 'shared/stats' %>
<%= render 'follow_form' if user_signed_in? %>

<p>自己紹介: <%= @user.profile %></p>

<% if user_signed_in? && current_user == @user %>
  <%= link_to "プロフィール編集", edit_user_path(@user) %>
  <%= link_to "アカウント設定", edit_user_registration_path %>
  <%= link_to "下書き一覧", drafts_posts_path %>
<% end %>

<h2><%= @user.name %>さんの投稿</h2>
<div id="user_posts">
  <% @posts.each do |post| %>
    <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 8px;">
      <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
        <h3><%= link_to post.post, post_path(post), style: "margin: 0; text-decoration: none; color: #333;" %></h3>
        <% streak_count = post.streak_count %>
        <div class="streak-badge" style="background: <%= post.recorded_on > Date.current ? '#ff9800' : (streak_count > 0 ? '#4caf50' : '#f44336') %>; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8em;">
          <% if post.recorded_on > Date.current %>
            ⏰ 未来の投稿
          <% elsif streak_count > 0 %>
            🔥 <%= streak_count %>日継続中
          <% else %>
            💔 うっかり
          <% end %>
        </div>
      </div>
      <p><%= post.reason %></p>
      <p>カテゴリー: <%= post.category.name if post.category %></p>
      <p>作成日: <%= l post.recorded_on, format: :japanese %></p>
      <%= render 'shared/favorite_button', post: post %>
    </div>
  <% end %>
</div>
